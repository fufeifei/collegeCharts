$.ajax({type:"get",url:"./data/output.json",async:!0,success:function(dataSourse){function optionVal(ID,ids){var val=eval(ids);$.each(ID,function(e,o){$("#"+ids).append("<option>"+o+"</option>")})}var dataX=[],All=[],Alls=[],SchoolName=[],MajorCategories=[],ProfessionalCategory=[],ProfessionalName=[],Grade=[],Source=[];$.each(dataSourse,function(e,o){All=dataSourse,SchoolName.push(o.SchoolName),MajorCategories.push(o.MajorCategories),ProfessionalCategory.push(o.ProfessionalCategory),ProfessionalName.push(o.ProfessionalName),Grade.push(o.Grade)}),$.unique(SchoolName),$.unique(MajorCategories),$.unique(ProfessionalCategory),$.unique(ProfessionalName),optionVal(SchoolName,"SchoolName"),optionVal(MajorCategories,"MajorCategories"),optionVal(ProfessionalCategory,"ProfessionalCategory"),optionVal(ProfessionalName,"ProfessionalName");var x=1,value=[],ids=[],Sources=[],sourceAll=[],sourceRest=[],_select=$("#filter select");$("#filter select").on("change",function(){$("#table tbody").html(""),localStorage.ID=$(this).attr("data-index");var e=$(this).val(),o=$(this).attr("id"),t=($("#filter select").length,$(this).attr("data-index")),a=[];if(0==t?($(this).attr("data-index",x++),$.each(_select,function(e,o){0==$(o).attr("data-index")&&$(o).html("<option>请选择</option")})):t>0&&(a.push($("[data-index]")),$.each(_select,function(e,o){$(o).attr("data-index")>t&&$(o).html("<option>请选择</option")})),""!=a&&$.each(a[0],function(e,o){$("#"+$(o).attr("id")).attr("data-index")>t&&(value.splice(t-1,10),ids.splice(t-1,10),$("#"+$(o).attr("id")).attr("data-index","0"),x--)}),localStorage.ID!=$(this).attr("data-index")?ids.push(o):value.pop(),value.push(e),console.log(ids),console.log(value),""!=value)for(var s=0;s<value.length;s++)if(1==$(this).attr("data-index")){sourceAll=All,Sources=[];for(l=0;l<sourceAll.length;l++)sourceAll[l][ids[s]]==value[s]&&Sources.push(sourceAll[l])}else if($(this).attr("data-index")>1)if(0==localStorage.ID){sourceAll=Sources,Sources=[];for(l=0;l<sourceAll.length;l++)sourceAll[l][ids[s]]==value[s]&&(sourceRest.push(sourceAll[l]),Sources.push(sourceAll[l]))}else{$.each(_select,function(e,o){0==$(o).attr("data-index")&&$(o).html("<option>请选择</option")}),sourceAll=sourceRest,Sources=[];for(var l=0;l<sourceAll.length;l++)sourceAll[l][ids[s]]==value[s]&&Sources.push(sourceAll[l])}console.log(Sources);$(this).attr("data-index");$.each(Sources,function(e,o){var t="<tr><td>"+o.SchoolName+"</td><td>"+o.MajorCategories+"</td><td>"+o.ProfessionalCategory+"</td><td>"+o.ProfessionalName+"</td><td>"+o.SchoolSystem+"</td><td>"+o.Year+"</td><td>"+o.Graduate+"</td><td>"+o.Student+"</td><td>"+o.GradeOne+"</td><td>"+o.GradeTwo+"</td><td>"+o.GradeThree+"</td></tr>";$("#table tbody").append(t);var a=[];""!=_select&&($.each(_select,function(e,o){a.push($(o).attr("id"))}),$.each(ids,function(e,o){a.splice($.inArray(o,a),1)}));var s,l=[];$.each(a,function(e,t){s=t,l.push(o[t]),console.log(o[t]),$.each($.unique(l),function(e,o){$("#"+s).append("<option>"+o+"</option>")})}),console.log(l)})})}});